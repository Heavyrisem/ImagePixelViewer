<!DOCTYPE html>
 
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <div id="result"></div>
    <button onclick="func();">start</button>
    
    <script type="text/javascript">
        function func() {
            // nonBlock(function (result) {
            //     document.getElementById('result').innerText = result;
            // })
            nonBlock(() => {
                longjob((r) => {
                    nonBlock(() => {
                        document.getElementById('result').innerText = r;
                    })
                });
            })
            document.body.style.backgroundColor = '#008299';
        }
 
        function nonBlock(callback) {
            setTimeout(() => {
                callback();
            }, 0);
        }
 
        function longjob(cb) {
            var num = 0;
 
            for (var i = 0; i < 1000; i++) {
                cb(num)
                num++;
            }
 
            return num;
        }
    </script>
</body>
</html>
